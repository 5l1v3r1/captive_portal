/*!CK:2264312014!*//*1427096073,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["jU+VL"]); }

__d("MFeedAsyncClickLogger",["MRequest","Stratcom","destroyOnUnload"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(event){var l=event.getNode('log-click-async'),m={_ft_:l.getAttribute('data-ft'),__tn__:l.getAttribute('data-tn')},n=new g('/mtouch/feed/log/'),o=l.getAttribute('data-hrefTarget'),p=false,q=function(r){if(o&&!p){p=true;window.location=o;}};n.setData(m);n.setAutoRetry(true);n.setMethod('POST');n.listen('finally',q);n.send();window.setTimeout(q,1000);}var k=h.listen('click','log-click-async',j);i(function(){k.remove();});e.exports={logOnClick:j};},null);
__d("XAdsPreferencesFeedbackController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/ads\/preferences\/feeedback\/",{ad_id:{type:"Int",required:true},favorite:{type:"Enum",required:true,enumType:1}});},null);
__d("MAdsPrefsFeedback",["cx","CSS","DOM","MRequest","XAdsPreferencesFeedbackController"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(n,o){var p=o?'ad_useful':'ad_neutral',q=k.getURIBuilder().setInt('ad_id',n).setEnum('favorite',p).getURI(),r=new j(q);r.send();}var m={toggle:function(n,o,p,q){h.conditionClass(n,"_232h",true);n.addEventListener('webkitAnimationEnd',function(r){h.conditionClass(r.target,"_232h",false);i.replace(r.target,o);},true);l(p,q);}};e.exports=m;},null);
__d("MEditComposerEntry",["MComposition","MComposerLogger","MComposerWaterfallEvent","MComposerEntry","MComposerNavigation","MRequest"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={invoke:function(n,o,p){var q=new g(n),r=new l(o);j.invoke(q).then(function(s){s.xc_edit_callsite=p;var t=s.csid;r.listen('done',this._onSuccess.bind(this,t));r.listen('error',this._onError.bind(this,t));r.setData(s);r.setAutoRetry(true);r.setMethod('POST');r.listen('postprocess',function(u){k.cleanupSoftState();});r.send();}.bind(this));},_onSuccess:function(n){h.logWithSessionID(i.COMPOSER_POST_SUCCESS,n);},_onError:function(n){h.logWithSessionID(i.COMPOSER_POST_FAILURE,n);}};e.exports=m;},null);
__d("DocumentSnapShot",["ErrorUtils"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h;if('nextElementSibling' in document.documentElement){h=function(k){return k.nextElementSibling;};}else h=function(k){var l=k.nextSibling;while(l&&l.nodeType!==1)l=l.nextSibling;return l;};function i(k,l,m){var n=k,o=0,p=1,q=p,r=0,s,t=[];while(!(r===0&&q===o))switch(q){case p:s=false;s=m?g.applyWithGuard(m,a,[n],null,'traverse-filter'):true;t.push([r,n]);if(s)while(t.length>0)g.applyWithGuard(l,a,t.shift(),null,'traverse-walker');if(n.children.length>0){n=n.children[0];r++;}else q=o;break;case o:if(!s)t.pop();if(h(n)){n=h(n);q=p;}else{n=n.parentNode;r--;}break;}}function j(k){var l=[],m=function(o,p){l.push(new Array(o+1).join('  ')+p.tagName.toLowerCase()+(p.id?' id="'+p.id+'"':'')+(p.className?' class="'+p.className+'"':'')+(p.hasAttribute('data-sigil')?' sigil="'+p.getAttribute('data-sigil')+'"':''));},n=function(o){return !!(o.id||o.className||o.hasAttribute('data-sigil'));};i(k||document.documentElement,m,n);return l.join('\n');}e.exports.capture=j;},null);
__d("MBugNub",["DOM","ErrorUtils","LogHistory","MBugNubConfig","MURI","Stratcom","DocumentSnapShot"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n,o,p=[],q=[],r=[],s=a.location;if(j.uri)n=new k(j.uri).getPath();l.listen('history:change',null,function(fa){if(!t())s=a.location;});function t(fa){var ga=new k(n),ha=new k(fa||a.location);return (ha.normalize().getPath()===ga.normalize().getPath());}function u(fa){if(!j.graph_search||!j.search||!j.graph_search_feedback)return false;var ga=(new k(j.graph_search)).getPath(),ha=(new k(j.search)).getPath(),ia=new k(fa||a.location),ja=ia.normalize().getPath();return (ja.lastIndexOf(ga)===0||ja.lastIndexOf(ha)===0);}function v(){return x(j.graph_search_feedback);}function w(fa,ga,ha){return x(n,fa,ga,ha);}function x(fa,ga,ha,ia){var ja=new k(fa);ja.addQueryData('uri',new k(s).normalize().toString());ja.addQueryData('source',ga);ja.addQueryData('description',ha);ja.addQueryData('st',ia);return ja.toString();}function y(){if(a.FB_GKS.m_js_html_snapshot)o=m.capture();r=i.getEntries().slice();}function z(){return o;}function aa(fa){return r.slice(fa?Math.max(r.length-fa,0):0);}function ba(fa){p.push(fa);}function ca(fa){return p.slice(fa?Math.max(p.length-fa,0):0);}function da(fa,ga,ha,ia){var ja=document.getElementById(ga),ka=document.getElementById(ha),la=document.getElementById(ia),ma=document.getElementById(fa);if(ma){var na=z();if(na){var oa=g.find(ma,"input");oa.value=na;}else g.hide(ma);}var pa=ca(5);if(pa.length>0)ja.value='\n'+pa.map(function(ra){return ('  Message: '+ra.message+'\n'+(ra.guard?'  Guard: '+ra.guard+'\n':'')+(ra.stack?'  Stack: '+ra.stack+'\n':''));}).join('\n  --\n');var qa=aa(100);if(qa.length>0)ka.value='\n'+i.formatEntries(qa);if(q.length>0)la.value=JSON.stringify(q);}h.addListener(ba);function ea(fa,ga){q.push({queryId:fa,serialized:ga});}e.exports={isReportURI:t,getReportURI:w,isGraphSearchResult:u,getGraphSearchFeedbackURI:v,captureState:y,pushError:ba,fillValueInInputs:da,logFeedItem:ea};},null);
__d("SnapShotHook",["DocumentSnapShot"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i,j){if(j)i.snapshot=g.capture(j);}e.exports=h;},null);
__d("FbtLoggerImpl",["BanzaiLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={logImpression:function(i){g.log('FbtImpressionsLoggerConfig',{hash:i,sample_rate:100});}};e.exports=h;},null);
__d("ScriptLoaderSourceResolver",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=100,h=function(i){if(i.script===a.__LOADER__.originalURI||i.script==='<anonymous>'||i.script==='Unknown script code'){var j=a.__LOADER__.mapLineNumber(i.line);if(j)if(j.src){i.script=j.src;i.line=j.line;}else if(j.text)i.script='`'+j.text.trim().substr(0,g)+'`';}};e.exports=h;},null);
__d("XFeedInfiniteHscrollController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/feed\/infinite_hscroll\/",{ad_index_offset:{type:"Int",required:true},cursor:{type:"String",defaultValue:""},requested_ad_type:{type:"Enum",required:true,enumType:1},scroll_body_id:{type:"String"},loading_card_id:{type:"String"},serialized_context:{type:"String"}});},null);
__d("MAdsInfiniteHscrollLoader",["BanzaiLogger","CSS","DataStore","MAdsInfiniteHscrollLoaderConfig","MRequest","MInViewportManager","Stratcom","XFeedInfiniteHscrollController","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();function p(event){var aa=event.getData(),ba=aa.element,ca=i.get(ba);if(!ca.adType)return;var da=aa.scrollarea,ea=da.getScrollPageIndex(),fa=j.startFetchOffset;ca.fetchInitiated=false;ca.isStall=false;if(!ca.numStalls)ca.numStalls=0;var ga=ca.loadingCardID?ca.size-1:ca.size;if(j.adLimit&&ga>=j.adLimit){if(ca.loadingCardID){if(ea>=ca.size-1)da.scrollByPages(-1);y(ca);}}else{if(ea>=ca.size-1){if(ca.loadingCardID)x(ca,true);ca.numStalls++;ca.isStall=true;}if(ea!==0&&ea+fa>=ca.size-1){ca.fetchInitiated=true;u(ba);}}v('user_scroll_action',ba,false);}function q(event){var aa=event.getData(),ba=aa.element,ca=i.get(ba);if(!ca.adType)return;x(ca,false);}function r(event){var aa=event.getData(),ba=aa.element,ca=i.get(ba);if(!ca.adType)return;if(ca.loadingCardID){var da=ba.firstChild.firstChild.offsetHeight,ea=o(ca.loadingCardID);ea.style.height=da+'px';}}function s(event){p(event);}function t(aa){var ba=i.get(aa),ca=ba.scrollArea,da=ca.getScrollPageIndex(),ea=j.startFetchOffset,fa=ba.loadingCardID?ba.size-1:ba.size;if(j.adLimit&&fa>=j.adLimit||da!==0)return;if(da+ea>=ba.size-1){ba.fetchInitiated=true;u(aa);}v('hscroll_prefetch_load_more_request_sent',aa,false);}function u(aa){var ba=i.get(aa),ca=ba.scrollArea;if(!ba||ba.loading)return;ba.loading=true;var da=ba.loadingCardID?ba.size-1:ba.size,ea=n.getURIBuilder().setInt('ad_index_offset',da).setEnum('requested_ad_type',ba.adType.toString());if(ba.loadingCardID){ea.setString('loading_card_id',ba.loadingCardID);}else ea.setString('scroll_body_id',aa.firstChild.id);var fa=new k(ea.getURI());fa.listen('done',function(ga){var ha=-1;if(ga.payload){if(ba.fetchCount){ba.fetchCount++;}else ba.fetchCount=1;ba.size+=ga.payload.numAdsRendered;ha=ga.payload.numAdsRendered;}w('hscroll_load_more_response_received',aa,true,ha);ba.lastRequestTime=-1;ca.reflow();ba.loading=false;x(ba,false);m.invoke('m:ads-infinite-hscroll:loaded',null,aa);});ba.lastRequestTime=Date.now();fa.send();v('hscroll_load_more_request_sent',aa,false);}function v(aa,ba,ca){w(aa,ba,ca,-1);}function w(aa,ba,ca,da){var ea=i.get(ba),fa=ea.scrollArea,ga=fa.getScrollPageIndex(),ha=fa.getScrollPageCount(),ia=-1;if(ca&&ea.lastResponseTime!==-1)ia=Date.now()-ea.lastRequestTime;g.log('InfiniteHScrollClientLoggerConfig',{event_type:aa,ad_type:ea.adType.toString(),ad_index:ga,ad_count:ha,ad_limit:j.adLimit||-1,ads_remaining:ha-ga-1,initial_ad_count:ea.initialAdCount,num_server_calls:ea.fetchCount||0,num_stalls:ea.numStalls,is_stall:ea.isStall,num_ads_returned:da,is_fetch_in_progress:ea.loading||false,fetch_initiated:ea.fetchInitiated,request_response_duration:ia});}function x(aa,ba){if(j.loadingCardShimmer&&aa.loadingCardID){var ca=o(aa.loadingCardID);if(ca)if(ba){h.addClass(ca,'animating');}else h.removeClass(ca,'animating');}}function y(aa){if(aa.loadingCardID){var ba=o(aa.loadingCardID);if(ba){ba.parentNode.removeChild(ba);aa.size--;aa.scrollArea.reflow();}}aa.loadingCardID=null;}m.listen('MScrollArea:scrollend','egoScroller',s);m.listen('MScrollArea:scrollstart',null,q);m.listen('MScrollArea:create',null,r);var z={initPrefetch:function(aa){if(j.loadBeforeSwipe)m.listen('scroll',null,function(){if(l.isInViewport(aa))t(aa);});}};e.exports=z;},null);
__d("MAdsScrollOnMarginTap",["DataStore","DOM","Stratcom","MScrollAreaHelper","BanzaiODS"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l='scroller-item-mask';function m(event){var q=event.getData();o(q.element);}function n(q){o(q.getData());}function o(q){var r=g.get(q);if(!r.scrollOnMarginTap)return;h.scry(q,'div',l).forEach(h.remove);var s=r.scrollArea,t=s.getScrollPageIndex(),u=s.getChildAtPageIndex(t),v={height:u.offsetHeight+'px',position:'absolute',top:0,width:u.offsetWidth+'px',zIndex:99};if(!s.isFirstPage()){var w=h.create('div',{onclick:s.scrollByPages.bind(s,-1),sigil:l,style:v}),x=s.getChildAtPageIndex(t-1);x.appendChild(w);}if(!s.isLastPage()){var y=h.create('div',{onclick:p.bind(),sigil:l,style:v}),z=s.getChildAtPageIndex(t+1);z.appendChild(y);}}function p(event){var q=j.findScrollArea(event.toElement);q.scrollByPages(1);k.bumpEntityKey('feed_ads','m_site_tap_on_margin_next');}i.listen('MScrollArea:create',null,m);i.listen('MScrollArea:scrollend','egoScroller',m);i.listen('m:ads-infinite-hscroll:loaded',null,n);e.exports={};},null);
__d("MDynamicAdLogger",["$","DataStore","DOM","FBJSON","MarauderLogger","MLogger","Stratcom","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o='first_hscroll_ad_shown',p='new_hscroll_ad_shown',q='item',r='pixelContainer',s;function t(){if(!s){s=m.listen('MScrollArea:scrollend','egoScroller',v);m.listen('m:page:unload',null,function(){m.removeCurrentListener();s.remove();s=null;});}}function u(z){var aa=g(z),ba=h.get(aa),ca=x(aa,0);ca.forEach(function(da){if(da.element){w(aa,da);var ea=h.get(da.element),fa={uid:ba.userId,adid:ea.adId,size:ba.size};k.log(o,ba.loggingModule,fa);}});}function v(event){var z=event.getData(),aa=z.element,ba=h.get(aa),ca=z.scrollarea,da=ca.getScrollPageIndex(),ea=ca.getScrollPageCount(),fa=x(aa,da);fa.forEach(function(ga){var ha=y(aa)?(ea-1)*ba.groupSize+1:ea*ba.groupSize;if(ba.size==ga.count&&ba.size==ha&&ga.element){w(aa,ga);var ia=h.get(ga.element),ja={scrolled_by_user:z.scrolledByUser,pos:ga.position,size:ba.size,uid:ba.userId,adid:ia.adId};k.log(p,ba.loggingModule,ja);}else{var ka=ba.size+", "+ga.count+", "+ea+", ";if(aa){var la=aa.getAttribute('data-store');ka+="id="+aa.getAttribute('data-store-id');ka+=" data="+la;try{ka+=" meta=";for(var na in ba)ka+=na+",";z=j.parse(la,e.id);ka+=" size2="+z.size;}catch(ma){if(typeof JSON!=="undefined"){ka+=" err";}else ka+=" err2";}}l.mustfix('Unexpected number of items reported by scrollArea : '+ka);}});}function w(z,aa){if(aa.element){var ba=h.get(aa.element),ca=i.scry(z.parentNode,'span',r)[0];if(ca&&ba.pixel){i.appendContent(ca,n(ba.pixel));ba.pixel=null;}}}function x(z,aa){if(z){var ba=i.scry(z,'*',q);if(!ba||ba.length<=0){l.mustfix('no item sigil under scroll area');return [];}var ca=null,da=i.scry(z,'*','scroll-area-body')[0];if(da){if(aa>=da.children.length){l.mustfix('pageIndex '+aa+' is larger then total page number '+da.children.length);return [];}var ea=da.children[aa];ca=m.hasSigil(ea,q)?[ea]:i.scry(ea,'*',q);var fa=h.get(z);if(!fa||!fa.groupSize||(fa.groupSize<ca.length)){l.mustfix('More number of items in a group then expected: group size: '+(fa&&fa.groupSize)?fa.groupSize:'unknown'+' item number:'+ca.length);return [];}}else{if(aa!==0){l.mustfix('try to get page index not 0 when not scrolling. Index '+aa);return [];}ca=ba;}return ca.map(function(ga){return {element:ga,count:ba.length,position:h.get(ga).position};});}}function y(z){return (i.scry(z,'*','m-hscroll-ego-loading').length>0);}e.exports={init:t,logImpression:u};},null);
__d("XAdsPreferencesAdInfoController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/ads\/preferences\/",{ad_id:{type:"Int"},tracking:{type:"String"},optout_url:{type:"String"},rtb_partner_id:{type:"Int"},show_ad_choices:{type:"Bool",defaultValue:false},__asyncDialog:{type:"Int"}});},null);
__d("MHideStoryActions",["$","Banzai","BanzaiLogger","copyProperties","CSS","cx","DOM","DataStore","MActionBubbleHelper","MAdsPrefsFeedback","MBugNub","MParent","MPageController","MRequest","MEditComposerEntry","SaveStateHandler","setTimeoutAcrossTransitions","Stratcom","URI","XAdsPreferencesAdInfoController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();var aa='storyFlyout',ba='appendPhotosStoryButton',ca='hideStoryButton',da='unfollowActorButton',ea='blockActorPostsButton',fa='markAsSpamStoryButton',ga='afroDirectAction',ha='removeStoryButton',ia='removeReviewButton',ja='editHistoryButton',ka='editPostButton',la='write-recommendation',ma='editPostComposer',na='publishNowButton',oa='reschedulePostButton',pa='editPrivacyButton',qa='turnOffNotifButton',ra='zombieStoryButton',sa='reportBug',ta='aboutThisAdButton',ua='fitnessEditButton',va='saveButton',wa='memorialPinButton',xa='groupPinButton',ya='getNotificationsButton',za='stopNotificationsButton',ab='saved_for_later:caret_action',bb='click',cb='imp',db='markAsSoldButton',eb='markAvailableButton',fb='hideStoryOnClick',gb='action-title',hb='action-subtitle',ib='adsPreferences',jb='adsPreferencesFeedback',kb='moreOptions',lb='backButton',mb=[ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,fb,gb,ib,jb,db,eb],nb=5,ob='enabled_action',pb='unfold_action',qb='NFXResolveProblemAction',rb=false,sb=null;function tb(){clearTimeout(sb);rb=false;}x.listen('m:page:render:cache:start',null,function(){rb=true;clearTimeout(sb);sb=w(tb,50);x.listen('m:page:iui:response:complete',null,function(){tb();x.removeCurrentListener();});});x.listen('m:page:loading',null,tb);var ub={};function vb(oc){var pc=new y(oc);pc.removeQueryData('gfid');return pc.toString();}function wb(oc,pc){if(!rb)ub[vb(oc)]=pc;}function xb(oc){return ub[vb(oc)];}function yb(event,oc){var pc=oc.getCausalElement(),qc=n.get(pc),rc=zb(pc),sc=n.get(rc),tc=sc.linkdata,uc=null;if(event.getNode(ca)){uc=qc.hideURI;}else if(event.getNode(da)||event.getNode(ea)){uc=qc.hideAllURI;}else if(event.getNode(fa)){uc=qc.markAsSpamURI;}else if(event.getNode(ha)||event.getNode(ia)){uc=qc.removeURI;}else if(event.getNode(ja)){uc=qc.editHistoryURI;}else if(event.getNode(qa)){uc=qc.turnOffNotifURI;}else if(event.getNode(ga)){var vc=event.getNode(ga);uc=n.get(vc).uri;}else if(event.getNode(ta)){uc=qc.aboutThisAdURI;}else if(event.getNode(ib)){uc=qc.adsPrefsURI;}else if(event.getNode(na)){uc=qc.publishNowURI;}else if(event.getNode(oa)){uc=qc.reschedulePostURI;}else if(event.getNode(va)){var wc=v.isSaveAction(qc.saveInfo.objectIDs);uc=wc?qc.saveInfo.saveURI:qc.saveInfo.unsaveURI;}else if(event.getNode(wa)){uc=qc.memorialPinInfo.URI;}else if(event.getNode(xa)){uc=qc.groupPinInfo.URI;}else if(event.getNode(ya)||event.getNode(za)){var xc=new y(qc.setNotificationsURI);xc.addQueryData('subscribe',!!event.getNode(ya));uc=xc.toString();}else if(event.getNode(db)){uc=qc.markAsSoldURI;}else if(event.getNode(eb))uc=qc.markAvailableURI;var yc=new y(uc);yc.addQueryData('dom_id',rc.id);var zc=qc.hideParams;if(!zc){yc.addQueryData('_ft_',tc);return yc;}var ad=n.get(m.find(rc,'div','scroll-area')),bd=ad.scrollArea,cd=bd.getChildAtPageIndex(bd.getScrollPageIndex()),dd=n.get(m.find(cd,'*','hScrollingItem')),ed=zc[dd.position];yc.addQueryData(ed);var fd=n.get(cd).adId,gd=n.get(cd).linkdata;if(gd)tc=gd;if(fd){n.set(rc,{ai:fd});tc+=':ai.'+fd;}yc.addQueryData('_ft_',tc);return yc;}function zb(oc){var pc=r.bySigil(oc,'story-popup-metadata');return pc;}function ac(oc){if(oc===va||oc===ga||oc===wa||oc===xa){return null;}else return oc;}function bc(event,oc){var pc;for(var qc=0;qc<mb.length;qc++){var rc=mb[qc];if(event.getNode(rc)){if(rc===ga){var sc=event.getNode(rc);pc=n.get(sc).option_name;}else if(rc===va){var tc=n.get(event.getNode(aa)).layer,uc=n.get(tc.getCausalElement()).saveInfo,vc=v.isSaveAction(uc.objectIDs);pc=vc?'save':'unsave';}else if(rc===wa){sc=event.getNode(rc);var wc=n.get(sc).pinning;pc=wc?'memorialPin':'memorialUnpin';}else if(rc===xa){sc=event.getNode(rc);wc=n.get(sc).pinning;pc=wc?'groupPin':'groupUnpin';}else pc=ac(rc);break;}}if(pc)cc(pc,'clk',oc);}function cc(oc,pc,qc){var rc,sc,tc;if(qc){rc=qc.is_self_story;sc=qc.is_sponsored;tc=qc.location;}i.log('FeedStoryOptionMenuLoggerConfig',{option_name:oc,event_type:pc,is_sponsored:sc,is_self_story:rc,m_touch_feed_location:tc});}function dc(oc,pc){if(pc){k.removeClass(oc,"_53l_");k.addClass(oc,"_53m0");}else{k.removeClass(oc,"_53m0");k.addClass(oc,"_53l_");}}function ec(oc,pc){var qc=n.get(oc);qc.uri=pc.uri;qc.option_name=pc.option_name;var rc=m.find(oc,'div',gb);rc.textContent=pc.title;var sc=m.scry(oc,'div',hb)[0];if(sc){var tc=pc.chevron_subtitle;if(tc){sc.textContent=tc;}else k.addClass(rc,"_320v");}var uc=m.scry(oc,'i')[0];if(uc)m.replace(uc,pc.icon);o.toggleActionBubbleItem(oc,true);if(pc.option_name===qb){x.addSigil(oc,pb);}else x.removeSigil(oc,pb);}function fc(oc,pc,qc,rc){for(var sc in pc)if(pc.hasOwnProperty(sc)){var tc=m.scry(oc,'*',sc)[0];if(tc){var uc=pc[sc];o.toggleActionBubbleItem(tc,uc);if(uc){var vc=ac(sc);if(vc)cc(vc,'imp',rc);switch(sc){case ba:var wc=n.get(tc);wc.dialogURI=qc.appendPhotosURI;break;case ka:var xc=n.get(tc);xc.dialogURI=qc.editPostURI;break;case la:var yc=qc.rating_info,zc=n.get(tc);zc=j(zc,yc);n.set(tc,zc);break;case na:var ad=n.get(tc);ad.dialogURI=qc.publishNowURI;break;case oa:var bd=n.get(tc);bd.dialogURI=qc.reschedulePostURI;break;case pa:var cd=n.get(tc);cd.dialogURI=qc.editPrivacyURI;var dd=m.scry(tc,'i')[0];if(dd)m.replace(dd,qc.privacyIcon);break;case ja:var ed=n.get(tc);ed.dialogURI=qc.editHistoryURI;break;case ua:var fd=n.get(tc);fd.dialogURI=qc.fitnessEditURI;break;case va:var gd=qc.saveInfo,hd=v.isSaveAction(gd.objectIDs),id=v.isInTransition(gd.objectIDs),jd=m.find(tc,'div',gb);jd.textContent=hd?gd.saveTitle:gd.unsaveTitle;k.conditionClass(tc,"_kh1",id);var kd=gd.logData;h.post(ab,{action:cb,collection_id:kd.collection_id,surface:kd.surface,story_id:kd.story_id,is_save:hd,is_multi:kd.is_multi});if(hd){cc('save','imp',rc);}else cc('unsave','imp',rc);x.addSigil(tc,pb);break;case wa:var ld=n.get(tc);ld.dialogURI=qc.memorialPinInfo.URI;var md=m.find(tc,'div',gb);md.textContent=qc.memorialPinInfo.text;break;case xa:var nd=n.get(tc);nd.dialogURI=qc.groupPinInfo.URI;k.conditionClass(tc,"_2bhl",qc.groupPinInfo.pinning);break;case jb:var od=m.scry(tc,'i')[0];if(od){var pd=qc.adsPrefsFeedbacks[0]?qc.adsPrefsIconActive:qc.adsPrefsIconPassive;m.replace(od,pd);}x.addSigil(tc,pb);break;case ib:x.addSigil(tc,pb);break;case kb:x.addSigil(tc,pb);break;}}}}}function gc(){var oc=n.get(this.getCausalElement()),pc=this.getRoot();k.removeClass(pc,"_53m1");k.addClass(pc,"_53m2");var qc=oc.storyInfo;cc('root','clk',qc);var rc={};rc[kb]=!!oc.chevron_cleanup;rc[lb]=false;rc[ra]=!!oc.zombieStoryURI&&!!oc.isEmployeeAccount;rc[sa]=!!oc.isEmployeeAccount;rc[ta]=!!oc.aboutThisAdURI;rc[ca]=!!oc.hideURI;var sc=oc.setNotificationsURI,tc=sc&&xb(sc);rc[ya]=!!(sc&&!tc);rc[za]=!!tc;rc[ba]=!!oc.appendPhotosURI;var uc=!!oc.isEditComposer,vc=oc.rating_info,wc=!!oc.editPostURI;rc[ka]=wc&&!uc&&!vc;rc[ma]=wc&&uc&&!vc;rc[la]=wc&&!!vc;rc[ia]=!!oc.removeURI&&!!vc;rc[ha]=!!oc.removeURI&&!vc;rc[na]=!!oc.publishNowURI;rc[oa]=!!oc.reschedulePostURI;rc[ja]=!!oc.editHistoryURI;rc[qa]=!!oc.turnOffNotifURI;rc[pa]=!!oc.editPrivacyURI;rc[fa]=!!oc.markAsSpamURI;rc[ua]=!!oc.fitnessEditURI;rc[db]=!!oc.markAsSoldURI;rc[eb]=!!oc.markAvailableURI;var xc=m.scry(pc,'*',ga);if(xc){var yc=oc.afroDirectActions;for(var zc=0;zc<xc.length;zc++){var ad=xc[zc];if(yc&&yc[zc]){ec(ad,yc[zc]);cc(yc[zc].option_name,'imp',qc);}else o.toggleActionBubbleItem(ad,false);}}rc[va]=!!oc.saveInfo;rc[wa]=!!oc.memorialPinInfo;rc[xa]=!!oc.groupPinInfo;rc[ib]=!!oc.adID;rc[jb]=!!oc.adsPrefsIconActive;fc(pc,rc,oc,qc);if(!!oc.chevron_cleanup){var bd=0,cd=m.scry(pc,'*',pb);if(qc&&qc.is_sponsored){nb=6;}else nb=5;cd.forEach(function(ed){if(x.hasSigil(ed,ob))bd++;},this);var dd=m.scry(pc,'*',ob);dd.forEach(function(ed){var fd=x.hasSigil(ed,pb),gd=(bd<nb)&&x.hasSigil(ed,ga),hd=fd||gd;dc(ed,!hd);if(!fd&&gd)bd++;},this);if(bd<=1)dd.forEach(function(ed){var fd=x.hasSigil(ed,kb)||x.hasSigil(ed,lb);dc(ed,fd);},this);}}function hc(event){var oc=n.get(event.getNode(aa)),pc=oc.layer,qc=pc.getCausalElement(),rc=zb(qc),sc=event.getNode(fb),tc=n.get(qc),uc=tc.storyInfo;bc(event,uc);if(event.getNode(ra)){window.open(n.get(qc).zombieStoryURI);pc.hide();return;}if(event.getNode(sa)){pc.hide();q.captureState();s.forceLoad(q.getReportURI('StoryChevron','',n.get(qc).serializedStory));return;}if(event.getNode(ja)){s.load(n.get(qc).editHistoryURI);pc.hide();return;}if(event.getNode(ma)){u.invoke(tc.composition,tc.composer_uri,tc.edit_callsite);return;}var vc=n.get(qc).adID,wc=m.scry(rc,'div','scroll-area');if(wc.length){var xc=n.get(wc[0]),yc=xc.scrollArea,zc=yc.getChildAtPageIndex(yc.getScrollPageIndex());vc=n.get(zc).adId;}if(event.getNode(ib)){var ad=z.getURIBuilder().setInt('ad_id',vc).getURI();s.load(ad);pc.hide();return;}var bd=event.getNode(jb);if(bd){var cd=m.scry(bd,'i')[0],dd=!n.get(qc).adsPrefsFeedbacks[0],ed=dd?n.get(qc).adsPrefsIconActive:n.get(qc).adsPrefsIconPassive;p.toggle(cd,ed,vc,dd);n.set(qc,{adsPrefsFeedback:dd});return;}var fd=event.getNode(kb);if(fd){k.removeClass(pc.getRoot(),"_53m2");k.addClass(pc.getRoot(),"_53m1");var gd=m.scry(pc.getRoot(),'*',lb)[0];if(gd)o.toggleActionBubbleItem(gd,true);return;}var hd=event.getNode(lb);if(hd){k.removeClass(pc.getRoot(),"_53m1");k.addClass(pc.getRoot(),"_53m2");o.toggleActionBubbleItem(hd,false);return;}var id=yb(event,pc),jd=new t(id.toString());if(event.getNode(va)){var kd=n.get(qc).saveInfo,ld=v.isSaveAction(kd.objectIDs),md=v.isInTransition(kd.objectIDs);if(md)return;if(ld){v.saving(kd.objectIDs);}else v.unsaving(kd.objectIDs);jd.listen('error',function(){var pd=!v.isSaveAction(kd.objectIDs);if(pd){v.unsaved(kd.objectIDs);}else v.saved(kd.objectIDs);});var nd=kd.logData;h.post(ab,{action:bb,collection_id:nd.collection_id,surface:nd.surface,story_id:nd.story_id,is_save:ld,is_multi:nd.is_multi});}var od=event.getNode(ta);if(od){window.open(id.toString());return;}jd.send();sc&&m.hide(rc);pc.hide();}function ic(oc,event){var pc=event.getNode('undo-content');if(pc){var qc=n.get(pc).storyDomID,rc=n.get(event.getTarget());if(rc&&rc.href){var sc=n.get(g(qc)),tc=sc.linkdata;if(sc.ai)tc+=':ai.'+sc.ai;var uc=(new y(rc.href)).addQueryData('_ft_',tc),vc=new t(uc.toString());vc.send();}if(oc)m.show(g(qc));m.hide(pc);}}var jc,kc;function lc(){return jc;}function mc(){jc=null;for(var oc=0,pc=kc.length;oc<pc;oc++)kc[oc].remove();kc.length=0;}function nc(oc,pc){var qc=false;if(jc){qc=jc.isShown();jc.destroy();mc();}jc=oc;var rc=jc.getRoot();x.addSigil(rc,aa);kc=[jc.addListener('beforeshow',gc,jc),m.listen(rc,'click',null,hc),x.listen('m:page:unload',null,mc),x.listen('click','undo-hide-button',ic.bind(this,true)),x.listen('click','unfab-button',ic.bind(this,false))];x.invoke('m:story:action-bubble-initialized',null,{menuNubID:pc,wasOpen:qc});}e.exports={init:nc,getActionBubble:lc,setNotificationState:wb};},null);